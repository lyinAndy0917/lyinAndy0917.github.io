<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="An introduction to LQR control theory."><title>LQR Control</title>
<link rel=canonical href=https://lyinandy0917.github.io/p/control/lqr/><link rel=stylesheet href=/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css><meta property='og:title' content="LQR Control"><meta property='og:description' content="An introduction to LQR control theory."><meta property='og:url' content='https://lyinandy0917.github.io/p/control/lqr/'><meta property='og:site_name' content='ANDY尹樑'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta name=twitter:title content="LQR Control"><meta name=twitter:description content="An introduction to LQR control theory."><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_e02202f6717fc524.png width=300 height=309 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>ANDY尹樑</a></h1><h2 class=site-description>积硅步，行千里</h2></div></header><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><ol><li><a href=#code-example>Code Example</a></li></ol></li><li><a href=#dynamic-programming>Dynamic Programming</a><ol><li><a href=#bruteforce>Bruteforce</a></li><li><a href=#learning>Learning</a></li><li><a href=#riccati>Riccati</a></li></ol></li><li><a href=#comparison-with-pole-placement>Comparison with Pole Placement</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/control/>Control</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/control/lqr/>LQR Control</a></h2><h3 class=article-subtitle>An introduction to LQR control theory.</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>5 minute read</time></div></footer></div></header><section class=article-content><p>It&rsquo;s a state feedback just like pole placement, but it&rsquo;s optimal. It&rsquo;s optimal because it minimizes a cost function.
<strong>why</strong></p><ul><li><strong>Linear:</strong> because the system is linear (which means needs to be linearized)</li><li><strong>Quadratic:</strong> because the cost function is quadratic</li><li><strong>Regulator:</strong> because the goal is to stabilize the system</li></ul><h1 id=modeling>Modeling</h1><p>In LQR problems, having a linear model is a must.</p><p>The linear model might be from a nonlinear model that is linearized around an operating point.</p><p>And the building of this nonlinear model is ususally based on the lagrangian dynamics of the system.</p><h1 id=finite-horizon-lqr>Finite Horizon LQR</h1><ul><li>Why &ldquo;<strong>finite horizon</strong>&rdquo;? <strong>A:</strong> because the cost function is defined over a <strong>finite time horizon</strong></li><li>The goal is to reach a desired goal $x_g$ in finite time</li><li>When the desired goal is constant, the controller is a regulator</li><li>When the desired goal is time-varying, the controller is a tracker</li><li>In regulation problems, <strong>feedback</strong> is enough to stabilize the system</li><li>In tracking problems, <strong>feedforward</strong> is needed to stabilize the system</li><li>The <strong>cost (cost-to-go)</strong> function is the sum of the state and control cost</li></ul>$$
J = \frac{1}{2} \sum_{k=0}^{N-1} [(x_k - x_g)^T Q (x_k - x_g) + u_k^T R u_k] + \frac{1}{2} (x_N - x_g)^T Q_f (x_N - x_g)
$$<p>$J$: cost function<br>$N$: time horizon<br>$Q$: state cost matrix<br>$R$: control cost matrix$<br>$Q_f$: terminal state cost matrix<br>$u_k$: control at time k<br>$x_k$: state at time k<br>$x_g$: desired goal</p><h3 id=code-example>Code Example</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>scipy</span> <span class=kn>from</span> <span class=nn>signal</span><span class=p>,</span> <span class=n>linalg</span>
</span></span><span class=line><span class=cl><span class=c1># 1.39 1.55 20000 25854 1888.6 9.81 0.01</span>
</span></span><span class=line><span class=cl><span class=c1># Parameters for system dynamics</span>
</span></span><span class=line><span class=cl><span class=n>lr</span> <span class=o>=</span> <span class=mf>1.39</span>
</span></span><span class=line><span class=cl><span class=n>lf</span> <span class=o>=</span> <span class=mf>1.55</span>
</span></span><span class=line><span class=cl><span class=n>Ca</span> <span class=o>=</span> <span class=mi>20000</span>
</span></span><span class=line><span class=cl><span class=n>Iz</span> <span class=o>=</span> <span class=mi>25854</span>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=mf>1888.6</span>
</span></span><span class=line><span class=cl><span class=n>g</span> <span class=o>=</span> <span class=mf>9.81</span>
</span></span><span class=line><span class=cl><span class=n>dt</span> <span class=o>=</span> <span class=mf>0.01</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># System dynamics</span>
</span></span><span class=line><span class=cl><span class=n>A</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>              <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=p>(</span><span class=mi>2</span><span class=o>*</span><span class=n>Ca</span><span class=p>)</span><span class=o>/</span><span class=p>(</span><span class=n>m</span><span class=o>*</span><span class=n>lr</span><span class=p>),</span> <span class=p>(</span><span class=mi>2</span><span class=o>*</span><span class=n>Ca</span><span class=p>)</span><span class=o>/</span><span class=n>m</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>              <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span>
</span></span><span class=line><span class=cl>              <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=p>(</span><span class=mi>2</span><span class=o>*</span><span class=n>Ca</span><span class=o>*</span><span class=n>lf</span> <span class=o>-</span> <span class=mi>2</span><span class=o>*</span><span class=n>Ca</span><span class=o>*</span><span class=n>lr</span><span class=p>)</span><span class=o>/</span><span class=p>(</span><span class=n>Iz</span><span class=o>*</span><span class=n>lf</span><span class=p>),</span> <span class=p>(</span><span class=mi>2</span><span class=o>*</span><span class=n>Ca</span><span class=o>*</span><span class=n>lf</span> <span class=o>-</span> <span class=mi>2</span><span class=o>*</span><span class=n>Ca</span><span class=o>*</span><span class=n>lr</span><span class=p>)</span><span class=o>/</span><span class=p>(</span><span class=n>Iz</span><span class=o>*</span><span class=n>lf</span><span class=p>),</span> <span class=mi>0</span><span class=p>]])</span>
</span></span><span class=line><span class=cl><span class=n>B</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([[</span><span class=mi>0</span><span class=p>],</span> <span class=p>[</span><span class=mi>2</span><span class=o>*</span><span class=n>Ca</span><span class=o>/</span><span class=n>m</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=p>[</span><span class=mi>2</span><span class=o>*</span><span class=n>Ca</span><span class=o>*</span><span class=n>lf</span><span class=o>/</span><span class=n>Iz</span><span class=p>]])</span>
</span></span><span class=line><span class=cl><span class=n>C</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>eye</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>D</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=mi>4</span><span class=p>,</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># generate Q and R according to the size of A and B</span>
</span></span><span class=line><span class=cl><span class=n>Q</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>eye</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>R</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>eye</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Discretize the system dynamics</span>
</span></span><span class=line><span class=cl><span class=n>system_cont</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>StateSpace</span><span class=p>(</span><span class=n>A</span><span class=p>,</span> <span class=n>B</span><span class=p>,</span> <span class=n>C</span><span class=p>,</span> <span class=n>D</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>system_disc</span> <span class=o>=</span> <span class=n>system_cont</span><span class=o>.</span><span class=n>to_discrete</span><span class=p>(</span><span class=n>dt</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Ad</span><span class=p>,</span> <span class=n>Bd</span> <span class=o>=</span> <span class=n>system_disc</span><span class=o>.</span><span class=n>A</span><span class=p>,</span> <span class=n>system_disc</span><span class=o>.</span><span class=n>B</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#solve for the P that optimizes the cost function using the discrete algebraic Riccati equation</span>
</span></span><span class=line><span class=cl><span class=n>P</span> <span class=o>=</span> <span class=n>linalg</span><span class=o>.</span><span class=n>solve_discrete_are</span><span class=p>(</span><span class=n>Ad</span><span class=p>,</span> <span class=n>Bd</span><span class=p>,</span> <span class=n>Q</span><span class=p>,</span> <span class=n>R</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>K</span> <span class=o>=</span> <span class=n>linalg</span><span class=o>.</span><span class=n>inv</span><span class=p>(</span><span class=n>R</span> <span class=o>+</span> <span class=n>Bd</span><span class=o>.</span><span class=n>T</span> <span class=o>@</span> <span class=n>P</span> <span class=o>@</span> <span class=n>Bd</span><span class=p>)</span> <span class=o>@</span> <span class=n>Bd</span><span class=o>.</span><span class=n>T</span> <span class=o>@</span> <span class=n>P</span> <span class=o>@</span> <span class=n>Ad</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>e1</span> <span class=o>=</span> <span class=n>x</span> <span class=o>-</span> <span class=n>x_g</span>
</span></span><span class=line><span class=cl><span class=c1># x = [x, x_dot, y, y_dot] just for example</span>
</span></span><span class=line><span class=cl><span class=n>u</span> <span class=o>=</span> <span class=o>-</span><span class=n>K</span> <span class=o>@</span> <span class=n>e1</span>
</span></span></code></pre></td></tr></table></div></div><p>All the code above is just to find the optimal control $u$ that minimizes the cost function $J$.
The detail implementation of the Riccati equation would be shown below.</p><h2 id=dynamic-programming>Dynamic Programming</h2><p>Known</p><ul><li>The system dynamics A, B</li><li>The cost function J</li><li>The terminal cost $Q_f$</li><li>The time horizon N</li></ul><h3 id=bruteforce>Bruteforce</h3><ul><li>Compute the cost-to-go for all possible states and controls</li><li>Choose the control that minimizes the cost-to-go = optimize the cost function</li><li><strong>Computational complex</strong> needs a lot of tuning</li></ul><h3 id=learning>Learning</h3><ul><li>gradient descent the cost function</li><li>Flexibility in the cost function</li></ul><h3 id=riccati>Riccati</h3><ul><li>Riccati is used to compute the optimal feedback gain matrix $K$</li></ul><ol><li>introduce P. what is this P? P is solution to the Riccati equation, it&rsquo;s added to simplify the cost function</li><li>now $J = x_0^T P x_0 - x_0^T P x_0 + \int_0^N (x^T Q x + u^T R u) dt$</li><li>By doing a trick called <strong>completing the square</strong>, now we have
$$
J = x_0^T P x_0 + \int_0^N (x^T(A^T P + PA + Q - PBR^{-1}B^T P)x + (u+R^{-1}B^T P x)^T R (u+R^{-1}B^T P x)) dt
$$</li><li>so now it&rsquo;s easy to see that the optimal control is $u = -R^{-1}B^T P x$</li><li>Since $u = -Kx$, we can find K by $K = R^{-1}B^T P$</li><li>Now we can find P by solving the Riccati equation</li><li>The Riccati equation is $A^T P + PA - PBR^{-1}B^T P + Q = 0$<br>$P = Q + A^T P A - A^T P (A-BK)$</li><li>Since this is a quadratic equation, there would be two possible solutions, one is stable and the other is unstable
The stable solution is the one we are looking for.</li></ol>$$
\frac{\partial J}{\partial u} = 0 \\
u^* = -[R+B^TPB]^{-1}B^TPA
$$$$
R + B^TPB > 0
$$<p>global minimum</p><p><strong>How it actually works</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-julia data-lang=julia><span class=line><span class=cl><span class=n>P</span> <span class=o>=</span> <span class=n>zeros</span><span class=p>(</span><span class=n>n</span><span class=p>,</span><span class=n>n</span><span class=p>,</span><span class=n>N</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>K</span> <span class=o>=</span> <span class=n>zeros</span><span class=p>(</span><span class=n>m</span><span class=p>,</span><span class=n>n</span><span class=p>,</span><span class=n>N</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>P</span><span class=p>[</span><span class=o>:</span><span class=p>,</span><span class=o>:</span><span class=p>,</span><span class=n>N</span><span class=p>]</span> <span class=o>.=</span> <span class=n>Qn</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Backward Riccati recursion</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>k</span> <span class=o>=</span> <span class=p>(</span><span class=n>N</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span><span class=o>:-</span><span class=mi>1</span><span class=o>:</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>K</span><span class=p>[</span><span class=o>:</span><span class=p>,</span><span class=o>:</span><span class=p>,</span><span class=n>k</span><span class=p>]</span> <span class=o>.=</span> <span class=p>(</span><span class=n>R</span> <span class=o>+</span> <span class=n>B</span><span class=o>&#39;*</span><span class=n>P</span><span class=p>[</span><span class=o>:</span><span class=p>,</span><span class=o>:</span><span class=p>,</span><span class=n>k</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span><span class=o>*</span><span class=n>B</span><span class=p>)</span><span class=o>\</span><span class=p>(</span><span class=n>B</span><span class=o>&#39;*</span><span class=n>P</span><span class=p>[</span><span class=o>:</span><span class=p>,</span><span class=o>:</span><span class=p>,</span><span class=n>k</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span><span class=o>*</span><span class=n>A</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>P</span><span class=p>[</span><span class=o>:</span><span class=p>,</span><span class=o>:</span><span class=p>,</span><span class=n>k</span><span class=p>]</span> <span class=o>.=</span> <span class=n>Q</span> <span class=o>+</span> <span class=n>A</span><span class=o>&#39;*</span><span class=n>P</span><span class=p>[</span><span class=o>:</span><span class=p>,</span><span class=o>:</span><span class=p>,</span><span class=n>k</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span><span class=o>*</span><span class=p>(</span><span class=n>A</span><span class=o>-</span><span class=n>B</span><span class=o>*</span><span class=n>K</span><span class=p>[</span><span class=o>:</span><span class=p>,</span><span class=o>:</span><span class=p>,</span><span class=n>k</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span></code></pre></td></tr></table></div></div><ol><li>Starting from the last time step, compute the optimal feedback gain matrix K and the solution to the Riccati equation P</li><li>Move backward in time and compute the optimal feedback gain matrix K and the solution to the Riccati equation P
<strong>Q:</strong> In Riccati is only one k is calculated, or is k dynamically changing?
<strong>A:</strong> k is changing, it&rsquo;s a loop that goes from N-1 to 1</li></ol><p>Every time step, we compute the optimal feedback gain matrix K and the solution to the Riccati equation P. We would put them in a matrix and do feedback policy for each time step control.</p><h2 id=comparison-with-pole-placement>Comparison with Pole Placement</h2><ul><li>Pole placement is a special case of LQR</li><li>The problem with pole placement is<ul><li>You could only tune the poles and affect the transient response. You can&rsquo;t tune the steady-state error</li><li>The transition from the response plot to the physcal system is not very translational. Which means while you could tune the pole to make the system more stable, the connection between the pole and the performance is not very clear.</li></ul></li><li>In LQR, you could tune the Q and R to directly modify the error and the control effort.</li></ul><h1 id=infinite-horizon-lqr>Infinite Horizon LQR</h1>$$
J = \sum_{k=0}^{\infty} [(x_k - x_g)^T Q (x_k - x_g) + u_k^T R u_k]
$$<p>The difference is that in infinite horizon LQR, we don&rsquo;t have a clear terminal state. While in finite LQR, the context is usually to complete a task or to reach a goal, in infinite LQR, the context is usually to design a controller (with a proper K) that stabilizes the system.</p></section><footer class=article-footer><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".main-article");renderMathInElement(e,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/control/><div class=article-image><img src=/p/control/robo.52d829d1a7846d9f68d0a5681f6925c7_hu_8fc7a6a2da6c7ce0.png width=250 height=150 loading=lazy alt="Featured image of post Control" data-hash="md5-Utgp0aeEbZ9o0KVoH2klxw=="></div><div class=article-details><h2 class=article-title>Control</h2></div></a></article><article><a href=/p/discretization/><div class=article-details><h2 class=article-title>Discretization</h2></div></a></article><article><a href=/p/foundation/><div class=article-details><h2 class=article-title>Foundation</h2></div></a></article><article><a href=/p/mpc/><div class=article-details><h2 class=article-title>Model Predictive Control</h2></div></a></article><article><a href=/p/pid-control/><div class=article-details><h2 class=article-title>PID Control</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//hugo-theme-stack.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 ANDY尹樑</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>